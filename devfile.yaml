schemaVersion: 2.1.0
metadata:
  name: java-simple
# attributes:
#   che-theia.eclipse.org/sidecar-policy: USE_DEV_CONTAINER
components:
  - name: tools
    container:
      image: quay.io/eclipse/che-java11-maven:next
      memoryLimit: 3Gi

      env:
        - name: MAVEN_CONFIG
          value: ""

        - name: JAVA_OPTS
          value: "-XX:MaxRAMPercentage=50.0 -XX:+UseParallelGC -XX:MinHeapFreeRatio=10
                -XX:MaxHeapFreeRatio=20 -XX:GCTimeRatio=4 -XX:AdaptiveSizePolicyWeight=90
                -Dsun.zip.disableMemoryMapping=true -Xms20m -Djava.security.egd=file:/dev/./urandom
                -Duser.home=/home/user"

        - name: MAVEN_OPTS
          value: $(JAVA_OPTS)

      volumeMounts:
        - name: m2
          path: /home/user/.m2

  - name: mongo
    container:
      image: quay.io/eclipse/che--centos--mongodb-36-centos7:latest-ffdf2431bbc6d9a9d2a03e95bbbe8adb49ab9eac301f268a35038c84288259c1
      memoryLimit: 300Mi
      env:
      - name: MONGODB_USER
        value: user

      - name: MONGODB_PASSWORD
        value: password

      - name: MONGODB_DATABASE
        value: guestbook
        
      - name: MONGODB_ADMIN_PASSWORD
        value: password
      
      volumeMounts:
        - name: mongodbdata
          path: /var/lib/mongodb/data

  - name: m2
    volume:
      size: 1G

  - name: mongodbdata
    volume:
      size: 1G